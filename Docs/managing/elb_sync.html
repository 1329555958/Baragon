<!DOCTYPE HTML>
<html lang="en" >
    <!-- Start book Baragon -->
    <head>
        <!-- head:start -->
        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <title>ELB Sync | Baragon</title>
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="generator" content="GitBook 2.6.7">
        
        
        <meta name="HandheldFriendly" content="true"/>
        <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
        <meta name="apple-mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-status-bar-style" content="black">
        <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../../gitbook/images/apple-touch-icon-precomposed-152.png">
        <link rel="shortcut icon" href="../../gitbook/images/favicon.ico" type="image/x-icon">
        
    <link rel="stylesheet" href="../../gitbook/style.css">
    
        
        <link rel="stylesheet" href="../../gitbook/plugins/gitbook-plugin-search/search.css">
        
    
        
        <link rel="stylesheet" href="../../gitbook/plugins/gitbook-plugin-fontsettings/website.css">
        
    
    

        
    
    
    <link rel="next" href="../../Docs/development.html" />
    
    
    <link rel="prev" href="../../Docs/managing/basepaths.html" />
    

        <!-- head:end -->
    </head>
    <body>
        <!-- body:start -->
        
    <div class="book"
        data-level="3.5"
        data-chapter-title="ELB Sync"
        data-filepath="Docs/managing/elb_sync.md"
        data-basepath="../.."
        data-revision="Fri May 20 2016 16:53:16 GMT-0400 (EDT)"
        data-innerlanguage="">
    

<div class="book-summary">
    <nav role="navigation">
        <ul class="summary">
            
            
            
            

            

            
    
        <li class="chapter " data-level="0" data-path="index.html">
            
                
                    <a href="../../index.html">
                
                        <i class="fa fa-check"></i>
                        
                        Introduction
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="1" >
            
            <span><b>1.</b> About Baragon</span>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.1" data-path="Docs/about/basics.html">
            
                
                    <a href="../../Docs/about/basics.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>1.1.</b>
                        
                        Basics
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="Docs/about/getting_started.html">
            
                
                    <a href="../../Docs/about/getting_started.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>1.2.</b>
                        
                        Getting Started
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="2" data-path="Docs/api.html">
            
                
                    <a href="../../Docs/api.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.</b>
                        
                        Baragon API Docs
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="3" data-path="Docs/managing_baragon.html">
            
                
                    <a href="../../Docs/managing_baragon.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.</b>
                        
                        Managing Baragon
                    </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="3.1" data-path="Docs/managing/terminology.html">
            
                
                    <a href="../../Docs/managing/terminology.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.1.</b>
                        
                        Terminology
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="3.2" data-path="Docs/managing/launch.html">
            
                
                    <a href="../../Docs/managing/launch.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.2.</b>
                        
                        Launching a Cluster
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="3.3" data-path="Docs/managing/requests.html">
            
                
                    <a href="../../Docs/managing/requests.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.3.</b>
                        
                        Making Requests to Baragon Service
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="3.4" data-path="Docs/managing/basepaths.html">
            
                
                    <a href="../../Docs/managing/basepaths.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.4.</b>
                        
                        BasePath Locking and Updating
                    </a>
            
            
        </li>
    
        <li class="chapter active" data-level="3.5" data-path="Docs/managing/elb_sync.html">
            
                
                    <a href="../../Docs/managing/elb_sync.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.5.</b>
                        
                        ELB Sync
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="4" data-path="Docs/development.html">
            
                
                    <a href="../../Docs/development.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>4.</b>
                        
                        Developing
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="5" data-path="Docs/config/config.html">
            
                
                    <a href="../../Docs/config/config.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>5.</b>
                        
                        Example Configuration
                    </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="5.1" data-path="Docs/config/baragon_agent_config.html">
            
                
                    <a href="../../Docs/config/baragon_agent_config.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>5.1.</b>
                        
                        Example Agent Config
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="5.2" data-path="Docs/config/baragon_service_config.html">
            
                
                    <a href="../../Docs/config/baragon_service_config.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>5.2.</b>
                        
                        Example Service Config
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    


            
            <li class="divider"></li>
            <li>
                <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
                    Published with GitBook
                </a>
            </li>
            
        </ul>
    </nav>
</div>

    <div class="book-body">
        <div class="body-inner">
            <div class="book-header" role="navigation">
    <!-- Actions Left -->
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="../../" >Baragon</a>
    </h1>
</div>

            <div class="page-wrapper" tabindex="-1" role="main">
                <div class="page-inner">
                
                
                    <section class="normal" id="section-">
                    
                        <h2 id="elb-sync">ELB Sync</h2>
<p><code>BaragonService</code> has the ability to keep you instances in sync with a traffic source (Right now only Amazon ELB). You can specify the following under <code>elb</code> in you <code>BaragonService</code> config to enable the ELB Sync and configure several safeguards.</p>
<ul>
<li><code>enabled</code>: Must be <code>true</code> for the elb sync worker to run, defaults to <code>false</code></li>
<li><p><code>awsAccessKeyId</code>, <code>awsAccessKeySecret</code>: AWS access key and secret. The IAM credentials require the following permissions</p>
<ul>
<li><code>DeregisterInstancesFromLoadBalancer</code></li>
<li><code>RegisterInstancesWithLoadBalancer</code></li>
<li><code>DescribeLoadBalancers</code></li>
<li><code>DescribeInstanceHealth</code></li>
</ul>
<p><em>Adding AWS keys will enable a visual ELBs page in the UI, even if the ELB Sync worker is not enabled</em></p>
</li>
<li><p>ElbSyncWorker Configuration</p>
<ul>
<li><code>intervalSeconds</code>: The interval at which to run the elb sync worker, default is <code>120</code> seconds, can be no shorter than a minute</li>
<li><code>initialDelaySeconds</code>: Initial delay after startup before trying to start the elb sycn worker, default is <code>0</code></li>
<li><code>removeLastHealthyEnabled</code>: If this is <code>false</code>, Baragon will not be allowed to deregister a healthy agent from the ELB if it is the last healthy instance registered with that ELB. Defaults to <code>false</code></li>
<li><code>removeKnownAgentEnabled</code>: If this is <code>false</code>, Baragon will not be allowed to deregister an agent if it is still in the known agents list. Defaults to <code>false</code></li>
<li><code>removeKnownAgentMinutes</code>: Number of minutes after which Baragon is allowed to deregister an agent that is still in the knownAgents list. (ie. has not been active in x minutes). This has no effect if <code>removeKnownAgentEnabled</code> is false. Default is 30 minutes.</li>
<li><code>deregisterEnabled</code>: If this is <code>false</code>, Baragon will only be allowed to register new agents, not deregister. Defaults to <code>false</code></li>
</ul>
</li>
</ul>
<p>BaragonService will also use <code>PathChildrenCacheListener</code>s to watch for the addition of new agents to the cluster. This way, new agents will be in the elb as soon as they have applied their configuration successfully.</p>
<p>Once BaragonService is running with valid AWS credentials, you can add a <code>trafficSource</code> to a load balancer group. This corressponds to the ELB name associated with that group. You can add multiple traffic sources. Baragon will then attempt to keep the active agents in its datastore in sync with the agents registered with the ELB.</p>

                    
                    </section>
                
                
                </div>
            </div>
        </div>

        
        <a href="../../Docs/managing/basepaths.html" class="navigation navigation-prev " aria-label="Previous page: BasePath Locking and Updating"><i class="fa fa-angle-left"></i></a>
        
        
        <a href="../../Docs/development.html" class="navigation navigation-next " aria-label="Next page: Developing"><i class="fa fa-angle-right"></i></a>
        
    </div>
</div>

        
<script src="../../gitbook/app.js"></script>

    
    <script src="../../gitbook/plugins/gitbook-plugin-github/plugin.js"></script>
    

    
    <script src="../../gitbook/plugins/gitbook-plugin-copy-code-button/toggle.js"></script>
    

    
    <script src="../../gitbook/plugins/gitbook-plugin-search/lunr.min.js"></script>
    

    
    <script src="../../gitbook/plugins/gitbook-plugin-search/search.js"></script>
    

    
    <script src="../../gitbook/plugins/gitbook-plugin-fontsettings/buttons.js"></script>
    

<script>
require(["gitbook"], function(gitbook) {
    var config = {"github":{"url":"https://github.com/HubSpot/Baragon"},"copy-code-button":{},"search":{"maxIndexSize":1000000},"fontsettings":{"theme":"white","family":"sans","size":2}};
    gitbook.start(config);
});
</script>

        <!-- body:end -->
    </body>
    <!-- End of book Baragon -->
</html>
